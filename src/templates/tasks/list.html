{% extends "base.html" %}
{% block title %}My Tasks â€” TaskFlow{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">

    <!-- Header -->
    <div class="flex items-center justify-between mb-8">
        <div>
            <h1 class="text-2xl font-bold text-slate-100 tracking-tight">My Tasks</h1>
            <p class="text-sm mt-0.5" style="color:#64748b;">
                {{ tasks|length }} active task{{ 's' if tasks|length != 1 else '' }}
            </p>
        </div>
        <a href="/tasks/new"
           class="inline-flex items-center gap-2 px-4 py-2.5 rounded-lg text-sm font-semibold text-white transition-all duration-150 hover:opacity-90 active:scale-95"
           style="background:#6366f1;">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 4v16m8-8H4"/>
            </svg>
            New Task
        </a>
    </div>

    {% if not tasks %}
    <!-- Empty state -->
    <div class="flex flex-col items-center justify-center py-24 rounded-xl"
         style="background:#1a1d27; border:1px solid rgba(99,102,241,.12);">
        <div class="w-16 h-16 rounded-full flex items-center justify-center mb-4"
             style="background:rgba(99,102,241,.1);">
            <svg class="w-8 h-8" style="color:#6366f1;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                      d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
        </div>
        <h3 class="text-base font-semibold text-slate-300 mb-1">No tasks yet</h3>
        <p class="text-sm mb-6" style="color:#64748b;">Create your first task to get started.</p>
        <a href="/tasks/new"
           class="px-4 py-2 rounded-lg text-sm font-medium"
           style="background:rgba(99,102,241,.15); color:#a5b4fc; border:1px solid rgba(99,102,241,.3);">
            + New Task
        </a>
    </div>

    {% else %}
    <div class="flex flex-col gap-2">
        {% for task in tasks %}
        <div class="group flex items-start gap-4 px-5 py-4 rounded-xl transition-all duration-150"
             style="background:#1a1d27;
                    border:1px solid rgba(255,255,255,.06);
                    border-left:3px solid {% if task.completed %}#22c55e{% else %}#6366f1{% endif %};">

            <!-- Toggle checkbox -->
            <form method="POST" action="/tasks/{{ task.id }}/toggle" class="flex-shrink-0 mt-0.5">
                <button type="submit"
                        class="w-5 h-5 rounded flex items-center justify-center transition-all duration-150 border cursor-pointer"
                        style="{% if task.completed %}background:rgba(34,197,94,.2);border-color:#22c55e;
                               {% else %}background:transparent;border-color:#334155;{% endif %}"
                        title="{{ 'Mark incomplete' if task.completed else 'Mark complete' }}">
                    {% if task.completed %}
                    <svg class="w-3 h-3" style="color:#22c55e;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                    </svg>
                    {% endif %}
                </button>
            </form>

            <!-- Content -->
            <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between gap-3">
                    <div class="min-w-0">
                        <span class="text-sm font-medium block truncate
                                     {% if task.completed %}line-through opacity-50{% else %}text-slate-100{% endif %}">
                            {{ task.title }}
                        </span>
                        {% if task.body %}
                        <p class="text-xs mt-0.5 truncate {% if task.completed %}opacity-40{% endif %}"
                           style="color:#64748b;">
                            {{ task.body[:100] }}{% if task.body|length > 100 %}â€¦{% endif %}
                        </p>
                        {% endif %}
                        {% if task.reminder_at %}
                        <span class="inline-flex items-center gap-1 mt-2 px-2 py-0.5 rounded text-xs font-medium"
                              style="background:rgba(99,102,241,.12); color:#a5b4fc; border:1px solid rgba(99,102,241,.2);">
                            ðŸ”” {{ task.reminder_at.strftime('%b %d, %Y %H:%M') }}
                        </span>
                        {% endif %}
                    </div>

                    <!-- Actions (visible on hover) -->
                    <div class="flex items-center gap-1.5 flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity duration-150">
                        <a href="/tasks/{{ task.id }}"
                           class="px-2.5 py-1 rounded text-xs font-medium transition-all duration-150"
                           style="color:#a5b4fc; background:rgba(99,102,241,.12); border:1px solid rgba(99,102,241,.2);">
                            View
                        </a>
                        <form method="POST" action="/tasks/{{ task.id }}/archive"
                              onsubmit="return confirm('Archive this task?')">
                            <button type="submit"
                                    class="p-1.5 rounded transition-all duration-150"
                                    style="color:#64748b;"
                                    title="Archive task"
                                    onmouseover="this.style.background='rgba(239,68,68,.15)'; this.style.color='#f87171';"
                                    onmouseout="this.style.background='transparent'; this.style.color='#64748b';">
                                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                                </svg>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

</div>
{% endblock %}
